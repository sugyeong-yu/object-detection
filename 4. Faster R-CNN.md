# Faster R-CNN
Deep Network를 사용해 Region Proposal을 진행하는 RPN(Region proposal networks)를 소개한다.\
![image](https://user-images.githubusercontent.com/70633080/103259626-8ac99980-49dd-11eb-8837-4053dc070d08.png)\
**즉, Fast R-CNN에서 selective search가 하던 일을 Faster R-CNN에서 RPN이 하는 것**
- RPN
RPN의 output들은 Fast R-CNN과 동일하게 ROI Pooling , Classification, Bbox regression을 진행하게 된다.
- input :  image의 Feature Map
- output : Object proposal들의 Sample
- R-CNN, Fast R-CNN, Faster R-CNN의 구조
![image](https://user-images.githubusercontent.com/70633080/103259764-1cd1a200-49de-11eb-8f5c-03373675e31d.png)
## RPN (Region Proposal Network)
> ![image](https://user-images.githubusercontent.com/70633080/103259872-9073af00-49de-11eb-895e-67a90fd0fdc2.png)
> 1. pretrained 된 CNN을 거쳐서 Feature Map추출.
> 2. Feature Map을 k개의 Anchor box를 통해 영역을 정한다.
> 3. Classification Layer와 Bounding box regression을 거쳐 물체위치를 학습한다.\
> - 이때, Classification layer는 물체의 유무를 판단하는 이진분류로 class수는 2이다.
> ### Anchor Targeting
> input image의 size를 800 * 800이라고 가정.
> - CNN을 거쳐 추출된 Feature Map에 **sliding window 방법으로 각 중심 좌표를 중심으로 k=9개의 anchor box를 만든다.**
> - Anchor box는 3개의 scale(8,16,32)과 3개의 ratio(0.5,1,2)를 통해 9개가 만들어 진다.
> ![image](https://user-images.githubusercontent.com/70633080/103260098-adf54880-49df-11eb-9971-1a347f05401b.png)
> 
