# SSD

- YOLO의 문제점
  - grid 크기보다 작은 물체를 잡아내지 못하는 문제점
  - 신경망을 모두 통과하면서 conv와 pooling을 거쳐 coarse한 정보만 남은 마지막 feature map만 사용하기 때문에 정확도가 낮음

- SSD의 발전
  - FC에서처럼 앞단 conv feature map을 끌어와 사용해 detail을 잡는다.
  - Faster RCNN의 anchor개념을 가져와 다양한 형태의 object도 detect한다.
  
## Multi Scale Feature Maps for Detection
- SSD는 YOLO와 달리 conv과정을 거치는 **중간중간 feature map들에서 모두 object detection을 수행**한다.\
![image](https://user-images.githubusercontent.com/70633080/108800536-c5634300-75d6-11eb-8ec1-42d8ab3713f9.png)
1. SSD는 300 * 300 의 이미지를 입력으로 받음
2. Imagenet으로 pretrained된 VGG의 Conv5_3층까지 통과하며 feature을 추출.
3. 추출된 feature map을 conv를 거쳐 다음 층에 넘겨줌과 동시에 object detecion수행
- 이전 FC network에서 에서 conv를 거치면서 디테일한 정보들이 사라지는 문제점을 해결\
![image](https://user-images.githubusercontent.com/70633080/108800699-3a367d00-75d7-11eb-9b75-66783753acbe.png)
- 각 단계별로 추출된 feature map은 Detector & Classifier를 통과시켜 Object Detection을 수행

### Detector & Classifier 구조
![image](https://user-images.githubusercontent.com/70633080/108800802-72d65680-75d7-11eb-92e1-4bbf7c372db8.png)
- conv 중간에 5 * 5 * 256 크기의 feature map을 대상으로 수행한다고 가정.
- 5 * 5는 yolo에서의 grid크기에 해당한다고 생각하면 됨.
1. 하나의 grid마다 크기가 각기 다른 Default Box들을 계산한다.
  - Default Box란 anchor의 개념으로 비율과 크기가 각기 다른 기본박스를 말함.
  - 이는 높은 해상도의 feature map에서는 작은물체를, 낮은 해상도에서는 큰 물체를 잘 잡아낼 것이라고 추측.
2. 찾아낸 박스들에 bounding box regression을 적용
3. Confidence level을 계산
4. feature map에 3 * 3 conv를 적용해(padding=1) bbox regression값을 계산
  - 이는 각 default box들의 x,y,w,h의 조절값으로 4차원벡터이며 예시에서는 인덱스 하나에 3개의 default box를 적용했으므로 결과 크기는 5 * 5 * 12이다.
5. 각각의 Default box마다 모든 클래스에 대해 classification (총 20개의 클래스 + 1배경클래스 * default box수 = 5 * 5 * 63)
6. object detection의 결과들을 모두 합하여 loss를 구한후 전체 네트워크를 학습시키는 1 stage object detection 모델을 구성한다.

## Default Boxes Generating
